apply plugin: 'java'


sourceSets {
    main {
        java {
            srcDir 'app'
        }
        resources {
            srcDir 'conf'
        }
    }
}

apply plugin: GreetingPlugin

greeting {
    message = 'Hi'
    greeter = 'Gradle'
}

buildscript {
    repositories {
        mavenCentral()
        ivy {
          url "http://repo.typesafe.com/typesafe/releases/"
          layout "maven"
        }
    }

    dependencies {
        classpath group: 'com.typesafe.play', name: 'play_2.10', version: '2.3.2'
        classpath group: 'com.typesafe.play', name: 'play-json_2.10', version: '2.3.2'
        classpath group: 'com.typesafe.play', name: 'twirl-compiler_2.10', version: '1.0.2'
      //classpath files("./java-overlay.jar")
    }
}

class GreetingPlugin implements Plugin<Project> {
    void apply(Project project) {
      //compy.TwirlCompiler compy = new compy.TwirlCompiler(new File("./app/views/index.scala.html"), new File("./app/views"), new File("supadupa"), "html", "", "utf-8", false, false)
      
      Project.extensions.create("greeting", GreetingPluginExtension)
      project.task('hello') << {
        println "${compy.test()} ${project.greeting.message} from ${project.greeting.greeter}"
      }
    }
}

class GreetingPluginExtension {
    String message
    String greeter
}